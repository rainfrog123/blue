//@version=6
indicator(title="Average True Range (Percent)", shorttitle="ATR%", overlay=false, timeframe="", timeframe_gaps=true)

length    = input.int(title="Length", defval=14, minval=1)
smoothing = input.string(title="Smoothing", defval="RMA", options=["RMA", "SMA", "EMA", "WMA"])
base_src  = input.source(title="Base Price for % (usually close)", defval=close)

ma_function(source, length) =>
    switch smoothing
        "RMA" => ta.rma(source, length)
        "SMA" => ta.sma(source, length)
        "EMA" => ta.ema(source, length)
        => ta.wma(source, length)

// absolute atr
atr_abs = ma_function(ta.tr(true), length)

// percent as a fraction (use format.percent)
atr_frac = atr_abs / base_src

// if you prefer numeric percent (e.g., 0.25 -> 0.25%), use this instead:
// atr_pct = (atr_abs / base_src) * 100

plot(atr_frac, title="ATR % of Price", color=color.new(#B71C1C, 0), linewidth=2, style=plot.style_line, format=format.percent)
// for numeric percent points, use:
// plot(atr_pct, title="ATR (%)", color=color.new(#B71C1C, 0), linewidth=2)
